import { useContext, useEffect } from 'react'
import { VManagerContext } from '../../context/VManagerContext'
import VulnerabilityRow from '../VulnerabilityRow'
import * as S from './styles'

const VulnerabilityTable = () => {
  const { vulnerabilities, handleVulnerabilities, token, handleToken } =
    useContext(VManagerContext)

  useEffect(() => {
    // if (!token) handleToken()
    if (vulnerabilities.length === 0) handleVulnerabilities()
  })
  return (
    <S.Wrapper>
      <div className="table-container">
        <div className="input">
          <input type="text" className="filter" placeholder="Search Filter" />
          <button type="button" className="search-button">
            Search
          </button>
        </div>

        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>V. Name</th>
              <th>Severity</th>
              <th>CVSS</th>
              <th>Publishing Date</th>
              <th>N. of hosts</th>
            </tr>
          </thead>
          <tbody>
            {vulnerabilities &&
              vulnerabilities.map((vulnerability) => (
                <VulnerabilityRow
                  key={vulnerability.id}
                  id={vulnerability.id}
                  title={vulnerability.title}
                  severity={vulnerability.severity}
                  cvss={vulnerability.cvss}
                  publication_date={vulnerability.publication_date}
                  asset_count={vulnerability.asset_count}
                />
              ))}
          </tbody>
        </table>

        <div className="footer">
          <p className="text-results">Showing 1-50 of 200 results</p>
          <div className="page-selector"> {'<< < 1 2 > >>'} </div>
        </div>
      </div>
    </S.Wrapper>
  )
}

export default VulnerabilityTable
